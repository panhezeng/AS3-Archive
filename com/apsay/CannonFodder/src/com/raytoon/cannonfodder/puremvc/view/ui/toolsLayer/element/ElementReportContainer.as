// /////////////////////////////////////////////////////////
// ElementReportContainer.as
// Macromedia ActionScript Implementation of the Class ElementReportContainer
// Generated by Enterprise Architect
// Created on:      28-十一月-2011 10:56:25
// Original author: LuXianli
// /////////////////////////////////////////////////////////
package com.raytoon.cannonfodder.puremvc.view.ui.toolsLayer.element {
	import com.raytoon.cannonfodder.tools.utils.UIClass;
	import com.raytoon.cannonfodder.tools.utils.UICommand;
	import com.raytoon.cannonfodder.tools.xml.XMLSource;

	import flash.display.DisplayObject;
	import flash.display.MovieClip;
	import flash.display.Sprite;
	import flash.system.ApplicationDomain;
	import flash.text.TextField;

	/**
	 * @author LuXianli
	 * @version 1.0
	 * @created 28-十一月-2011 10:56:25
	 */
	public class ElementReportContainer extends Sprite {
		public function ElementReportContainer() {
		}

		private var _containerArr : Array = [];

		/**
		 * 战报数据显示  
		 * @param	dataArr  单元素 数组
		 */
		public function showReportContainer(dataArr : Array) : void {
			var _my : int = 0;

			for (var i : int = 0; i < dataArr.length; i++ ) {
				var _objArr : Array = dataArr[i] as Array;
				var _mClass : Class = ApplicationDomain.currentDomain.getDefinition(UIClass.REPORT_CONTAINER) as Class;
				var _mc : Sprite = new _mClass() as Sprite;
				addChild(_mc);
				_mc.y = _my;
				(_mc as Object).data = _objArr;
				(_mc as Object).dataID = _objArr[0];
				(_mc["langDate"] as TextField).text = String(_objArr[1]);
				if (Boolean(_objArr[2])) {
					_mc["defence"].visible = false;
					_mc["all"].visible = false;
				} else {
					_mc["attack"].visible = false;
				}

				(_mc["langTitle1"] as TextField).text = Boolean(_objArr[2]) ? (String(XMLSource.getXMLSource("UISite.xml").phrase.nin) + String(XMLSource.getXMLSource("UISite.xml").phrase.challenge)) : (String(XMLSource.getXMLSource("UISite.xml").phrase.nin) + String(XMLSource.getXMLSource("UISite.xml").phrase.defence2));
				(_mc["langUserName"] as TextField).text = String(_objArr[4]) + " " + "LV." + String(_objArr[5]);
				// (_mc["langLevel"] as TextField).text = String(_objArr[4]);
				// (_mc["langChance"] as TextField).text = String(_objArr[5]);
				(_mc["langResult"] as TextField).text = Boolean(_objArr[7]) ? String(XMLSource.getXMLSource("UISite.xml").phrase.win) : String(XMLSource.getXMLSource("UISite.xml").phrase.lose);
				if (!(!Boolean(_objArr[2]) && !Boolean(_objArr[7])))_mc["money"].visible = false;
				if (Boolean(_objArr[7])) {
					_mc["red"].visible = false;
				} else {
					_mc["green"].visible = false;
				}
				// (_mc["langAppraise"] as TextField).text = String(_objArr[7]);
				(_mc["receive"] as MovieClip).visible = Boolean(_objArr[9]) ? false : true;
				if (Boolean(_objArr[2])) {
					(_mc["playback"] as MovieClip).visible = false;
					if (!Boolean(_objArr[9])) {
						(_mc["receive"] as MovieClip).x = (_mc["playback"] as MovieClip).x;
						(_mc["receive"] as MovieClip).y = (_mc["playback"] as MovieClip).y;
					}
				}
				_my += _mc.height + 8;
				_containerArr.push(_mc);
				_mc = null;
				_mClass = null;
				_objArr = null;
			}
		}

		/**
		 * 格式化毫秒为 月-日
		 * @param	num
		 * @return
		 */
		private function formatTime(num : Number) : String {
			var _date : Date = new Date(num);
			return _date.getUTCFullYear().toString() + "-" + pad((_date.getUTCMonth() + 1).toString(), 2) + "-" + pad(_date.getUTCDate().toString(), 2);
		}

		// 补0
		private function pad(num : String, n : int) : String {
			if ((num + "").length >= n) {
				return num;
			}
			return pad("0" + num, n);
		}

		/**
		 * 清理显示战报数据
		 */
		public function clear() : void {
			for each (var mc:Sprite in _containerArr) {
				removeChild(mc);
				mc = null;
			}
			_containerArr = [];
		}

		/**
		 * 领取奖励后隐藏领取奖励按钮
		 * @param	id
		 */
		public function changeGetReward(id : *) : void {
			for each (var obj:Object in _containerArr) {
				if (obj.dataID == id) {
					obj.receive.visible = false;
					return;
				}
			}
		}
	}
	// end ElementReportContainer
}